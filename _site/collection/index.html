<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Mini-Spider教程</title>
    <meta name="description" content="">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_8v3czwksspqlg14i.css">
    <link rel="stylesheet" href="/css/main.css ">
    <link rel="canonical" href="http://localhost:4000/collection/">
    <link rel="alternate" type="application/rss+xml" title="ZYunH" href="http://localhost:4000/feed.xml ">


    <script>
    // 百度统计代码
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?7e1108e5a215c70a3d2905ee073e5c63";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>




</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/" class="brand">ZYunH</a>
        <small>Developer</small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/">
                    
                        <i class="fa fa-home"></i>Home
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>Archives
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>Categories
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/tag/">
                        
                            <i class="fa fa-tags"></i>Tags
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a class="active" href="/collection/">
                            
                            <i class="fa fa-bookmark"></i>Mini-Spider教程
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/aboutme/">
                        
                            <i class="fa fa-heart"></i>About me
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" post>
    <div class="left">
        <h1>Mini-Spider教程</h1>
        <hr>
        <p>作者：<a href="https://github.com/ZYunH">ZhangYunHao</a></p>

<p>Mini-Spider是一个实用的爬虫工具，它的意义在于快速获得你所要的资源，而不用去关注诸如爬虫构造、数据存储、网络环境、语言实现等一系列的事情。现在你只需要简单的几个命令，就可以获得你需要的东西！</p>

<ul id="markdown-toc">
  <li><a href="#1安装" id="markdown-toc-1安装">1.安装</a>    <ul>
      <li><a href="#11-安装python3x" id="markdown-toc-11-安装python3x">1.1 安装python3.x</a></li>
      <li><a href="#12-安装mini-spider" id="markdown-toc-12-安装mini-spider">1.2 安装Mini-Spider</a></li>
    </ul>
  </li>
  <li><a href="#2快速入门" id="markdown-toc-2快速入门">2.快速入门</a>    <ul>
      <li><a href="#21-分析网址" id="markdown-toc-21-分析网址">2.1 分析网址</a></li>
      <li><a href="#22-创建提取器" id="markdown-toc-22-创建提取器">2.2 创建提取器</a></li>
      <li><a href="#23-开始爬取" id="markdown-toc-23-开始爬取">2.3 开始爬取</a></li>
      <li><a href="#24-启动下载器" id="markdown-toc-24-启动下载器">2.4 启动下载器</a></li>
    </ul>
  </li>
  <li><a href="#3内置命令" id="markdown-toc-3内置命令">3.内置命令</a>    <ul>
      <li><a href="#31-命令列表" id="markdown-toc-31-命令列表">3.1 命令列表</a></li>
      <li><a href="#32-分析网址" id="markdown-toc-32-分析网址">3.2 分析网址</a>        <ul>
          <li><a href="#321-必要命令" id="markdown-toc-321-必要命令">3.2.1 必要命令</a></li>
          <li><a href="#322-可选命令" id="markdown-toc-322-可选命令">3.2.2 可选命令</a></li>
          <li><a href="#323-其他" id="markdown-toc-323-其他">3.2.3 其他</a></li>
        </ul>
      </li>
      <li><a href="#33-创建提取器" id="markdown-toc-33-创建提取器">3.3 创建提取器</a>        <ul>
          <li><a href="#331-自动创建" id="markdown-toc-331-自动创建">3.3.1 自动创建</a></li>
          <li><a href="#332-自定义创建" id="markdown-toc-332-自定义创建">3.3.2 自定义创建</a></li>
        </ul>
      </li>
      <li><a href="#34-启动爬虫程序" id="markdown-toc-34-启动爬虫程序">3.4 启动爬虫程序</a>        <ul>
          <li><a href="#341-必要命令" id="markdown-toc-341-必要命令">3.4.1 必要命令</a></li>
          <li><a href="#342-可选命令" id="markdown-toc-342-可选命令">3.4.2 可选命令</a></li>
        </ul>
      </li>
      <li><a href="#35-启动下载器" id="markdown-toc-35-启动下载器">3.5 启动下载器</a>        <ul>
          <li><a href="#351-必要命令" id="markdown-toc-351-必要命令">3.5.1 必要命令</a></li>
          <li><a href="#352-可选命令" id="markdown-toc-352-可选命令">3.5.2 可选命令</a></li>
          <li><a href="#353-其他" id="markdown-toc-353-其他">3.5.3 其他</a></li>
        </ul>
      </li>
      <li><a href="#36-数据库功能" id="markdown-toc-36-数据库功能">3.6 数据库功能</a>        <ul>
          <li><a href="#361-数据库的导出" id="markdown-toc-361-数据库的导出">3.6.1 数据库的导出</a></li>
          <li><a href="#362-数据库的导入" id="markdown-toc-362-数据库的导入">3.6.2 数据库的导入</a></li>
          <li><a href="#363-在终端中查看数据库内容" id="markdown-toc-363-在终端中查看数据库内容">3.6.3 在终端中查看数据库内容</a></li>
          <li><a href="#364-刷新数据库资源状态" id="markdown-toc-364-刷新数据库资源状态">3.6.4 刷新数据库资源状态</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="1安装">1.安装</h2>

<p>Mini-Spider是一个跨平台的工具，它只依赖于python官方库，理论上，任何可以运行python3.x的机器都可以运行Mini-Spider。</p>

<h3 id="11-安装python3x">1.1 安装python3.x</h3>

<p>任何平台，请先安装<a href="https://www.python.org/downloads/">Python3.x下载</a></p>

<h3 id="12-安装mini-spider">1.2 安装Mini-Spider</h3>

<p>在安装了python3.x后，有两种方法安装Mini-Spider</p>

<ul>
  <li>在github中安装最新版本的Mini-Spider(推荐)</li>
</ul>

<p>打开<a href="https://github.com/ZYunH/Mini-Spider">github-Mini-Spider</a>，点击右上角的‘’Clone or Download“,后选择”Download ZIP”。解压下载的ZIP文件后，切换到解压后的目录，执行</p>

<div class="language-console highlighter-rouge"><pre class="highlight"><code><span class="w">$ </span><span class="nc">python3</span><span class="kv"> setup.py install
</span></code></pre>
</div>

<ul>
  <li>使用pip安装Mini-Spider</li>
</ul>

<p>pip是python的一个包管理系统，可以让你便捷地管理系统上的python包。</p>

<p>安装python-pip(注意必须是python3.x版本的pip)：</p>

<p>Linux下</p>

<div class="language-console highlighter-rouge"><pre class="highlight"><code><span class="w">$ </span><span class="nc">sudo</span><span class="kv"> apt-get python3-pip
</span></code></pre>
</div>
<p>Mac OS、windows下，在第一步中使用官网安装的python3.x包自带pip</p>

<p>在终端或cmd中执行</p>

<div class="language-console highlighter-rouge"><pre class="highlight"><code><span class="w">$ </span><span class="nc">pip</span><span class="kv"> install mini-spider
</span></code></pre>
</div>

<p>注：mac中，若未安装pyenv，需将上述pip改为pip3，因为系统自带的pip版本只支持python2.x</p>

<h2 id="2快速入门">2.快速入门</h2>

<p>如果系统中安装了mini-spider，请在终端中输入如下命令来确认安装</p>

<div class="language-console highlighter-rouge"><pre class="highlight"><code><span class="w">$ </span><span class="nc">mini-spider</span><span class="kv">
</span>usage: mini-spider [OPTION]... [URL]...

MiniSpider makes it easy to create user-friendly spider.

optional arguments:
  -h, --help            show this help message and exit
  -a [URL] [[URL] ...]  Analysis a URL.
  -st [float]           Set similarity_threshold,default = 0.6
  -c [num] [[num] ...]  Choose block make extractor.
  -time [float]         Set timeout.(default: 2)
  -to [{u,r}]           Choose match data.(default: u)
  -n [name]             Name your extractor.it can be ignored.
  -start [URL]          Start spider to get url and resource.
  -download [Path]      Download all url from database.
  -m [RE] [[RE] ...]    Make extractor by user.
  -export [FileName]    Export url from database.
  -import [FileName]    Import url into database.
  -list  [ ...]         List url in url_list or resource.options: "u" or "r"
  -false []             Disable classification function in -download.
  -reset [{u,r}]        Reset database stats = 1.(default: u)
</code></pre>
</div>

<p>如果以上信息显示如上，则表示安装正确</p>

<h3 id="21-分析网址">2.1 分析网址</h3>

<p>mini-spider的一个特色就是自动定位并将资源分类。例如，你发现某个论坛上的图片（jpg格式）非常喜欢，但是一个个将其复制特别麻烦…你可以这样做</p>

<div class="language-console highlighter-rouge"><pre class="highlight"><code><span class="w">$ </span><span class="nc">mini-spider</span><span class="kv"> -a http://bbs.fengniao.com/forum/9373824.html jpg
</span></code></pre>
</div>

<p>在终端中，将会得到以下输出</p>

<div class="language-console highlighter-rouge"><pre class="highlight"><code>[0]:
---(0)http://bbs.qn.img-space.com/g3/M00/02/3E/Cg-40lggN4GIcjIsAAbtzNgksRcAADfQwP38xwABu3k334.jpg
---(1)http://bbs.qn.img-space.com/g3/M00/02/3E/Cg-40lggN8KIC5XmAAPNyGCOY3kAADfRAL7-zgAA83g069.jpg
...
[1]:
---(0)http://icon.fengniao.com/forum/images/complain_close.jpg
---(1)http://icon.fengniao.com/index/2016/images/jiaoquan/qrcode-b.jpg
...
[2]:
---(0)http://image3.fengniao.com/head/1185/80/1184655_0.jpg
---(1)http://image3.fengniao.com/head/129/80/128323_0.jpg
...
[3]:
---(0)http://img2.fengniao.com/290_module_images/240/58dcaa2287f13.jpg
---(1)http://img2.fengniao.com/290_module_images/240/58dcaa3e3cf75.jpg
---
...
</code></pre>
</div>

<p>（限于篇幅，部分资源使用…代替)</p>

<p>如果你将块编号为[0]中的任意地址复制到浏览器打开，你将会得到你所需要的图片。是不是很方便？</p>

<p><strong>-a</strong> 命令作用的查找一个网址中你所需要资源，第一个参数为网站地址，后面接着你所需要的资源类型（例如jpg doc html，注意不能加逗号，如 <del>.jpg</del> 这会造成解析错误！）</p>

<blockquote>
  <p>你也可以尝试，在你所需分析的网址后面加上不同的文件类型，你将会得到更多的资源，但是为了避免输出信息太多，难以识别（比如加上后面加html jpg，你将会得到上百条的资源信息），最好的方式是每次是分析一种类型资源。</p>

</blockquote>

<p>但是为了提取他们，我们需要更多的工作</p>

<h3 id="22-创建提取器">2.2 创建提取器</h3>

<p>通常，我们创建一个提取器是一件很麻烦的事情，特别对于一些新手们更是如此，你需要考虑正则表达式匹配、不断比对页面代码之类的事情。但是，在mini-spider下，你只需要简单的一个命令就可以创建提取器。</p>

<p>首先，观察上面的例子。你将会发现，处于资源块[0]中的图片，都是作者所发布的图片。你只需要在终端上输入</p>

<div class="language-console highlighter-rouge"><pre class="highlight"><code><span class="w">$ </span><span class="nc">mini-spider</span><span class="kv"> -c 0 -to r
</span>http://bbs.qn.img-space.com/[a-z][0-9]/[A-Z][0-9][0-9]/[0-9][0-9]/[0-9][A-Z]/[A-Z][a-z]-\S+?\.jpg
The extractor was created successfully！
</code></pre>
</div>

<p>这条命令的意思是，选择资源块[0]中的所有资源信息创建提取器，提取后的信息放入资源数据库中。</p>

<p><strong>-c</strong>指定你需要选择的资源块，有些时候，一个大的资源块并不完全符合你心中的愿望，可能会混入一些不需要的资源，你可以选择一个资源块的一部分来创建提取器。例如</p>

<div class="language-console highlighter-rouge"><pre class="highlight"><code><span class="w">$ </span><span class="nc">mini-spider</span><span class="kv"> -c 0 0 3 -to r
</span></code></pre>
</div>

<p>代表着选择块[0]中的0至3的资源（闭区间）来创建提取器。</p>

<div class="language-console highlighter-rouge"><pre class="highlight"><code><span class="w">$ </span><span class="nc">mini-spider</span><span class="kv"> -c 0 1 -to r
</span></code></pre>
</div>

<p>代表着选择块[0]中的1资源来创建提取器。</p>

<p><strong>-to</strong>以及后面的参数指定了提取后的信息去向。该参数仅有两个可选参数’-to u’或’-to r’，分别代表了提取后的信息放入url数据库(即包含所有需要爬取的url的数据库)或放入资源数据库中。</p>

<p>现在，你已经可以正确的提取你所要的资源了，但是，稍等！</p>

<p>你还需要定义下一个你需要爬取的地址，否则你只能提取当前页面的资源。</p>

<p>很显然，你需要提取下一个页面的url来进行爬取。</p>

<p>现在让我们再来分析一下刚才的url，但是，此时的资源类型为html。我们在浏览器中，点击该论坛下一页，会发现它的地址是http://bbs.fengniao.com/forum/9373824_2.html。</p>

<p>输入</p>

<div class="language-console highlighter-rouge"><pre class="highlight"><code><span class="w">$ </span><span class="nc">mini-spider</span><span class="kv"> -a http://bbs.fengniao.com/forum/9373824.html html
</span></code></pre>
</div>

<p>输出的信息很多，但是我们会发现块[5]中的2号资源符合我们的预期。</p>

<div class="language-console highlighter-rouge"><pre class="highlight"><code>...
[5]:
---(0)http://bbs.fengniao.com/forum/2879928.html
---(1)http://bbs.fengniao.com/forum/9373824.html
---(2)http://bbs.fengniao.com/forum/9373824_2.html
---(3)http://bbs.fengniao.com/forum/forum_11.html
...
</code></pre>
</div>

<p>输入</p>

<div class="language-console highlighter-rouge"><pre class="highlight"><code><span class="w">$ </span><span class="nc">mini-spider</span><span class="kv"> -c 5 2 -to u
</span>Host:http://bbs.fengniao.com
href="(/[a-z][a-z][a-z][a-z][a-z]/[0-9][0-9][0-9][0-9][0-9][0-9][0-9]_[0-9]\.html)"
The extractor was created successfully！
</code></pre>
</div>

<p>现在，我们获得了下个网址和相应资源的提取器，开始爬取吧！</p>

<h3 id="23-开始爬取">2.3 开始爬取</h3>

<p>这个步骤会不断读取url数据库的内容，然后提取相应的内容放入相应的数据库。</p>

<p>输入</p>

<div class="language-console highlighter-rouge"><pre class="highlight"><code><span class="w">$ </span><span class="nc">mini-spider</span><span class="kv"> -start http://bbs.fengniao.com/forum/9373824.html
</span>url: 1/1||resource: 9/9
url: 1/2||resource: 19/19
url: 1/3||resource: 21/21
url: 1/4||resource: 21/21
url: 1/5||resource: 21/21
url: 1/6||resource: 21/21
url: 1/7||resource: 21/21
url: 1/8||resource: 21/21
url: 0/8||resource: 21/21
</code></pre>
</div>

<p><strong>-start</strong>作用是开始爬取，从第一个url开始（即-start后面紧跟的网址）不断将相应数据放入数据库中。</p>

<p>屏幕上会不断输出此时数据库的信息，直到无法爬取时，程序会自动停止，一些错误信息也会输出在屏幕上。</p>

<h3 id="24-启动下载器">2.4 启动下载器</h3>

<p>从上个步骤中，我们可以知道数据库已经爬取得到了21个资源，并自动关闭。</p>

<p>输入</p>

<div class="language-console highlighter-rouge"><pre class="highlight"><code><span class="w">$ </span><span class="nc">mini-spider</span><span class="kv"> -download -false
</span>Cg-77VggNSKISexrAAvLkt1pk-sAADfPgMOPsEAC8uq536.jpg completed            
Cg-40lggNLuITlKGAAaIKdnN16YAADfPAIfryoABohB596.jpg completed            
Cg-77VggNWmIVXTwAAP2OrqqXKIAADfPwG44UYAA_ZS536.jpg completed            
Cg-77VggNemIXgi7AAX2dyHXWx0AADfQAEwyIAABfaP695.jpg completed            
Cg-40lggNo2IdlT0AAiEl8en1M0AADfQQKQklQACISv087.jpg completed
...
</code></pre>
</div>

<p><strong>-download</strong>作用是启动下载器下载所有资源，默认放置如当前目录。</p>

<p><strong>-false</strong>作用是禁止下载器分类，如果没有这个命令，下载器会默认将所有资源依据提取他们的地址分类（即这些图片在不同的文件夹内），显然我们只需要所有图片，而不需要将他们依据不同的页面分开。</p>

<p>现在，你需要的所有图片已经在当前的目录下了！</p>

<h2 id="3内置命令">3.内置命令</h2>

<p>现在，就来具体地介绍所有的mini-spider的内置命令吧！</p>

<h3 id="31-命令列表">3.1 命令列表</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: left">命令</th>
      <th style="text-align: center">作用</th>
      <th style="text-align: center">参数</th>
      <th style="text-align: center">说明</th>
      <th style="text-align: left">示例</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">-h</td>
      <td style="text-align: center">帮助</td>
      <td style="text-align: center">无</td>
      <td style="text-align: center">查看程序帮助文档</td>
      <td style="text-align: left">mini-spider -h</td>
    </tr>
    <tr>
      <td style="text-align: left">-a</td>
      <td style="text-align: center">分析URL</td>
      <td style="text-align: center">[1,+oo]</td>
      <td style="text-align: center">分析相应的URL</td>
      <td style="text-align: left">mini-spider -a [URL] html</td>
    </tr>
    <tr>
      <td style="text-align: left">-st</td>
      <td style="text-align: center">设置相似度</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">分析URL时，可以选择合适的相似阈值进行分类，默认为0.6</td>
      <td style="text-align: left">mini-spider -a [URL] html -st 0.7</td>
    </tr>
    <tr>
      <td style="text-align: left">-time</td>
      <td style="text-align: center">设置等待时间</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">分析URL或下载时，设置等待时间，默认为2 秒</td>
      <td style="text-align: left">mini-spider -a [URL] html -st 0.7 -time 3</td>
    </tr>
    <tr>
      <td style="text-align: left">-c</td>
      <td style="text-align: center">选择合适的块创建提取器</td>
      <td style="text-align: center">[1,3]</td>
      <td style="text-align: center">分析完URL后，选择合适的块创建提取器。（-to为其必要选项）</td>
      <td style="text-align: left">mini-spider -c 0 2 4 -to u</td>
    </tr>
    <tr>
      <td style="text-align: left">-to</td>
      <td style="text-align: center">设置数据流向</td>
      <td style="text-align: center">{u,r}</td>
      <td style="text-align: center">设置数据流向，参数只有两个选项u和r。分别代表流向为URL数据库或资源数据库。</td>
      <td style="text-align: left">mini-spider -c 0 2 4 -to u</td>
    </tr>
    <tr>
      <td style="text-align: left">-m</td>
      <td style="text-align: center">自定义提取器</td>
      <td style="text-align: center">[1,2]</td>
      <td style="text-align: center">使用自定义的正则表达式来创建提取器，可以添加Host值。（-to为其必要选项）</td>
      <td style="text-align: left">mini-spider -m href=”/\S+?.jpg” www.example.com -to u</td>
    </tr>
    <tr>
      <td style="text-align: left">-n</td>
      <td style="text-align: center">定义名称</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">可选命令，自定义提取器名称，不使用则由程序自动创建</td>
      <td style="text-align: left">mini-spider -m href=”/\S+?.jpg” www.example.com -to u -n my_url</td>
    </tr>
    <tr>
      <td style="text-align: left">-start</td>
      <td style="text-align: center">开始爬取</td>
      <td style="text-align: center">[0,1]</td>
      <td style="text-align: center">参数可选，为第一个爬取的URL，若不提供则从数据库中提取</td>
      <td style="text-align: left">mini-spider -start www.example.com</td>
    </tr>
    <tr>
      <td style="text-align: left">-download</td>
      <td style="text-align: center">开始下载</td>
      <td style="text-align: center">[0,1]</td>
      <td style="text-align: center">参数可选，自定义下载路径，若不指定则在当前目录下载</td>
      <td style="text-align: left">mini-spider -download /User/zyh/test</td>
    </tr>
    <tr>
      <td style="text-align: left">-export</td>
      <td style="text-align: center">从数据库中导出url至文本文件</td>
      <td style="text-align: center">[filename]</td>
      <td style="text-align: center">参数为文件名（必要）。（-to为其必要选项，指定了从资源数据库或url数据库中导出url)</td>
      <td style="text-align: left">mini-spider -export 1.txt -to u</td>
    </tr>
    <tr>
      <td style="text-align: left">-import</td>
      <td style="text-align: center">从文本文件中导出url至数据库</td>
      <td style="text-align: center">[filename]</td>
      <td style="text-align: center">参数为文件名（必要）。（-to为其必要选项，指定了从文本文件提取的信息放入资源数据库或url数据库)</td>
      <td style="text-align: left">mini-spider -import 1.txt -to u</td>
    </tr>
    <tr>
      <td style="text-align: left">-list</td>
      <td style="text-align: center">打印数据库中信息至屏幕</td>
      <td style="text-align: center">[1,2]</td>
      <td style="text-align: center">第一个参数为必要，可选项为{u,r}，即选择url数据库或资源数据库。第二个参数可选，设置最大打印数目。</td>
      <td style="text-align: left">mini-spider -list u 5</td>
    </tr>
    <tr>
      <td style="text-align: left">-false</td>
      <td style="text-align: center">禁止</td>
      <td style="text-align: center">无</td>
      <td style="text-align: center">禁止数据库自动分类功能</td>
      <td style="text-align: left">mini-spider -download /User/zyh/test -false</td>
    </tr>
    <tr>
      <td style="text-align: left">-reset</td>
      <td style="text-align: center">重置数据库状态</td>
      <td style="text-align: center">{u,r}</td>
      <td style="text-align: center">将某个数据库中的所有url状态重置为可用，在下次爬取时会使用它们。</td>
      <td style="text-align: left">mini-spider -reset u</td>
    </tr>
  </tbody>
</table>

<p>以上是mini-spider所有命令，下面会根据它们使用的时机进行介绍。</p>

<h3 id="32-分析网址">3.2 分析网址</h3>

<p>自动将网址中的所需资源分类是Mini-Spider一大特色。</p>

<ul>
  <li>[✔️] 自动资源分类，提取href标签</li>
  <li>[✔️] 自定义相似度阈值</li>
  <li>[✔️] 自定义等待时间</li>
</ul>

<p>示例:</p>

<pre><code class="language-cons">$ mini-spider -a http://www.example.com html zip -st 0.8 -time 3
</code></pre>

<h4 id="321-必要命令">3.2.1 必要命令</h4>

<ul>
  <li><strong>-a</strong>，第一个参数为必要参数，如示例中的http://www.example.com</li>
</ul>

<blockquote>
  <p>尽量输入url的协议，如果不输入程序会自动补充协议为http，例如输入www.example.com会自动补充为http://www.example.com但是这种情况有时会出现协议错误。</p>
</blockquote>

<p>第二个参数为必要参数，即所需提取的资源类型，你至少输入一个，如示例中的 html zip</p>

<p>这些参数紧接在网址之后，这些参数会在程序中解析为通用正则表达式，所以例如 <del>.html</del> 这样的输入会造成解析错误，所以使用者不要加入逗号。</p>

<blockquote>
  <p>注意保持所分析资源类型数量，如果一次性分析很多，输出信息的数量巨大会造成观察困难。</p>
</blockquote>

<h4 id="322-可选命令">3.2.2 可选命令</h4>

<ul>
  <li><strong>-st</strong>，仅有一个参数，为必要参数，如示例中的 0.8</li>
</ul>

<p>这个参数可以指定资源分类的相似度阈值，默认为0.6</p>

<p>只有相似度大于这个值的一类资源才可以归为一个分类，一般不需要改变这个值。</p>

<blockquote>
  <p>一般来说，提高阈值，分的类就越多，反之亦然。</p>
</blockquote>

<ul>
  <li><strong>-time</strong>，仅有一个参数，为必要参数，如示例中的 3</li>
</ul>

<p>这个参数可以指定分析网站时的等待时间，默认为2，单位为 秒</p>

<h4 id="323-其他">3.2.3 其他</h4>

<ul>
  <li>默认情况下，每一块最多显示100个资源，如果超过这个值，便会显示 xxx is not displayed.此时可以提高参数<strong>-st</strong>来得到更多的分类从而减少每一块资源的数目</li>
  <li>此时，生成的信息会自动存储到一个名为mini-spider.temp的文件中，如果此时切换目录，下个环节中便不可以自动创建提取器（因为此时mini-spider.temp不在当前目录）</li>
</ul>

<h3 id="33-创建提取器">3.3 创建提取器</h3>

<p>这个环节中，你可以使用两种方式来创建提取器。一种是程序自动创建，一种是自己编写正则表达式创建。提取器后缀名为.extractor ，用户可以任意移动。程序启动时会自动检测当前目录的所有提取器，每次提取的内容会被所有提取器提取。</p>

<blockquote>
  <p>实际上，mini-spider的提取器是由一个正则表达式，还有一些补充信息构成</p>
</blockquote>

<ul>
  <li>[✔️] 自动创建正则表达式</li>
  <li>[✔️] 自动提取href信息并补充host信息</li>
  <li>[✔️] 自定义提取器及host信息</li>
</ul>

<h4 id="331-自动创建">3.3.1 自动创建</h4>

<p>示例：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ mini-spider -c 0 3 6 -to u -n next_url
</code></pre>
</div>

<p>必要命令</p>

<ul>
  <li><strong>-c</strong>，共有三个参数，第一个为必要参数，其后两个参数为可选。全部使用时如示例中的 -c 0 3 6</li>
</ul>

<p>三个参数全部使用，-c 0 3 6 代表着选择[0]块的3至6号资源来创建提取器（包括3和6）</p>

<p>只使用两个参数，-c 0 3 代表着选择[0]块的3号资源来创建提取器</p>

<p>只使用一个参数，-c 0  代表着选择[0]块的全部资源来创建提取器</p>

<blockquote>
  <p>建议使用尽量多的资源来创建提取器，这样可以提取成功率会大大提高。仅只用一个资源创建提取器时，精度会大大提高，但是提取成功率会大大降低。使用者需要根据实际平衡。</p>
</blockquote>

<ul>
  <li><strong>-u</strong>，仅有一个参数，选择数据流向，为必要参数。只能在-to u 和 -to r 中选择，-to u 代表着流向url数据库(to url database)，-to r代表着流向资源数据库(to resource database)</li>
</ul>

<p>可选命令</p>

<ul>
  <li><strong>-n</strong>，仅有一个参数，指定提取器名称，为必要参数。该参数不可加后缀名，例如 <del>next_url.txt</del> 为错误</li>
</ul>

<blockquote>
  <p>提取器名字会自动创建，程序启动时会自动检测当前目录的所有提取器，故其名字并不重要。此时创建的提取器会自动添加后缀名，即创建的文件名为next_url.extractor</p>
</blockquote>

<h4 id="332-自定义创建">3.3.2 自定义创建</h4>

<p>示例：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ mini-spider -m href="(\s+?\.html)" http://www.example.com -to u -n next_url
</code></pre>
</div>

<p>必要命令</p>

<ul>
  <li><strong>-m</strong>，共有两个参数，第一个参数为必要参数，第二个为可选参数。</li>
</ul>

<p>第一个参数为正则表达式，它是构成提取器的核心</p>

<p>第二个参数为补充参数，此参数会自动加入提取后的资源前，组成完整的url。一般为Host，例如在href标签中的资源提取出来后需要加上Host才能构成完整的url</p>

<ul>
  <li><strong>-u</strong>，仅有一个参数，选择数据流向，为必要参数。只有能在-to u 和 -to r 中选择，-to u 代表着流向url数据库(to url database)，-to r代表着流向资源数据库(to resource database)</li>
</ul>

<p>可选命令</p>

<ul>
  <li><strong>-n</strong>，仅有一个参数，指定提取器名称，为必要参数。该参数不可加后缀名，例如 <del>next_url.txt</del> 为错误</li>
</ul>

<blockquote>
  <p>提取器名字会自动创建，程序启动时会自动检测当前目录的所有提取器，故其名字并不重要。此时创建的提取器会自动添加后缀名，即创建的文件名为next_url.extractor</p>
</blockquote>

<h3 id="34-启动爬虫程序">3.4 启动爬虫程序</h3>

<p>启动爬虫程序，来获取url内容，这一步并不下载资源，只是将获得的资源放入相应数据库。</p>

<ul>
  <li>[✔️] 自动更新数据库状态</li>
  <li>[✔️] 错误检查，状态恢复</li>
  <li>[✔️] 自动停止</li>
</ul>

<p>示例：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ mini-spider -start http://www.example.com -time 3
</code></pre>
</div>

<h4 id="341-必要命令">3.4.1 必要命令</h4>

<ul>
  <li><strong>-start</strong>，仅有一个参数，为可选参数。作用为启动爬虫程序，不断从数据库中弹出url进行分析，然后将信息传入所有提取器，提取后的信息进入相应的数据库。</li>
</ul>

<p>参数指定了第一个爬取的url，如果不提供参数，则从数据库中弹出，如果数据库中没有可用url，则启动失败。</p>

<h4 id="342-可选命令">3.4.2 可选命令</h4>

<ul>
  <li><strong>-time</strong>，仅有一个参数，为必要参数，如示例中的 3</li>
</ul>

<p>这个参数可以指定分析网站时的等待时间，默认为2，单位为 秒</p>

<h3 id="35-启动下载器">3.5 启动下载器</h3>

<p>示例:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ mini-spider -download /Users/zyh/test -false
</code></pre>
</div>

<ul>
  <li>[✔️] 支持断点续传</li>
  <li>[✔️] 自动检查url，补充协议以及中文转义</li>
  <li>[✔️] 自动添加文件名</li>
  <li>[✔️] 自定义下载路径，自动分类</li>
  <li>[✔️] 支持ftp、http、https协议</li>
</ul>

<h4 id="351-必要命令">3.5.1 必要命令</h4>

<ul>
  <li><strong>-download</strong>，仅有一个参数，为可选参数。作用为启动下载器，不断从数据库中弹出资源url下载。</li>
</ul>

<p>参数指定了下载目录，绝对路径。如果没有指定，则程序默认选择当前目录作为下载目录。</p>

<h4 id="352-可选命令">3.5.2 可选命令</h4>

<ul>
  <li><strong>-false</strong>，无参数。作用是禁止下载器自动分类功能。</li>
</ul>

<blockquote>
  <p>自动分类功能：下载器默认启用，作用是将从不同url提取出来的资源放入不同的文件夹。</p>
</blockquote>

<h4 id="353-其他">3.5.3 其他</h4>

<ul>
  <li>
    <p>每次下载不成功时，该 url的状态不会变为0，而是依然为1，继续等待下次下载</p>
  </li>
  <li>
    <p>如果有错误导致下载不成功，重新运行即可，下载器有断点续传功能。</p>
  </li>
</ul>

<h3 id="36-数据库功能">3.6 数据库功能</h3>

<p>这一部分讲述文本文件与数据库之间的数据交换。数据库名为MiniSpider.db，单文件，可以自行移动。</p>

<ul>
  <li>[✔️] 使用错误自动恢复状态</li>
  <li>[✔️] 自动建立和检查数据库状态</li>
  <li>[✔️] 支持与纯文本文件的导入导出</li>
</ul>

<h4 id="361-数据库的导出">3.6.1 数据库的导出</h4>

<p>示例：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ mini-spider -export 1.txt -to u
</code></pre>
</div>

<p>必要命令</p>

<ul>
  <li><strong>-export</strong>，仅有一个参数，为必要参数。作用是导出数据库中的url放入文本文件中。</li>
</ul>

<p>参数的作用是指定导出文件名，纯文本文件，尽量加入后缀名 .txt</p>

<ul>
  <li><strong>-u</strong>，仅有一个参数，选择数据流向，为必要参数。只有能在-to u 和 -to r 中选择，-to u 代表着流向url数据库(to url database)，-to r代表着流向资源数据库(to resource database)</li>
</ul>

<blockquote>
  <p>-u参数选择了从资源数据库或是url数据库中导出</p>
</blockquote>

<p>其他</p>

<ul>
  <li>导出的文本文件会在每条内容后加入换行符”\n”方便观察</li>
</ul>

<h4 id="362-数据库的导入">3.6.2 数据库的导入</h4>

<p>示例：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ mini-spider -import 1.txt -to u
</code></pre>
</div>

<p>必要命令</p>

<ul>
  <li><strong>-import</strong>，仅有一个参数，为必要参数。作用是将文本文件中的数据放入数据库中。</li>
</ul>

<p>参数的作用是指定导入文件名，纯文本文件，需加入后缀名 .txt</p>

<ul>
  <li><strong>-u</strong>，仅有一个参数，选择数据流向，为必要参数。只能在-to u 和 -to r 中选择，-to u 代表着流向url数据库(to url database)，-to r代表着流向资源数据库(to resource database)</li>
</ul>

<blockquote>
  <p>-u参数选择导入url数据库或是资源数据库</p>
</blockquote>

<p>其他</p>

<ul>
  <li>导入的文本文件必须每条内容后加入换行符”\n”，如此程序才能正确解析</li>
</ul>

<h4 id="363-在终端中查看数据库内容">3.6.3 在终端中查看数据库内容</h4>

<p>示例：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ mini-spider -list u 10
</code></pre>
</div>

<p>必要命令</p>

<ul>
  <li><strong>-list</strong>，有两个参数，第一个必要，第二个可选。作用是将数据库中打印到终端中。</li>
</ul>

<p>第一个参数如同参数<strong>-to</strong>，作用是指定数据流，即从url数据库或是资源数据库打印。只能在u 和 r 中选择。</p>

<p>第二个参数可选，作用是选择最大打印数目，以免打印过多造成不便。</p>

<h4 id="364-刷新数据库资源状态">3.6.4 刷新数据库资源状态</h4>

<p>示例：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ mini-spider -reset u
</code></pre>
</div>

<blockquote>
  <p>数据库中每个url都具有一个状态，如果未被使用，他们的状态为1，如果被使用则变为0。</p>
</blockquote>

<p>必要命令</p>

<ul>
  <li><strong>-reset</strong>，仅有一个参数，选择数据流向，为必要参数。只能在-reset u 和 -reset r 中选择，-reset u 代表着刷新url数据库所有url状态为1，-reset u 代表着刷新资源数据库所有url状态为1</li>
</ul>

    </div>
    <button class="anchor"><i class="fa fa-anchor"></i></button>
    <div class="right">
        <div class="wrap">

            <!-- Content -->
            <div class="side content">
                <div>
                    Content
                </div>
                <ul id="content-side" class="content-ul">
                </ul>
            </div>
            <!-- 其他div框放到这里 -->
            <!-- <div class="side">bbbb</div> -->
        </div>
    </div>
</div>
<script src="/js/pageContent.js " charset="utf-8"></script>


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
             本站分享一些有意思的文章 
        </p>
        <p class="contact">
            Contact me at: 
            <a href="https://github.com/ZYunH" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a>  
            <a href="mailto:workvl@163.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a>  
            <a href="http://weibo.com/ZYunH_" title="Weibo"><i class="fa fa-weibo" aria-hidden="true"></i></a>   
            <a href="https://twitter.com/None" title="Twitter"><i class="fa fa-twitter" aria-hidden="true"></i></a>  
            <a href="https://www.facebook.com/None" title="Facebook"><i class="fa fa-facebook-official" aria-hidden="true"></i></a>    
        </p>
        <p>
            本站总访问量<span id="busuanzi_value_site_pv"></span>次，本站访客数<span id="busuanzi_value_site_uv"></span>人次，本文总阅读量<span id="busuanzi_value_page_pv"></span>次
        </p>
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>
            <span>
                Theme designed by <a href="https://github.com/Gaohaoyang">HyG</a>.
            </span>
        </p>
    </div>
</footer>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/smooth-scroll.min.js " charset="utf-8"></script>
    <script type="text/javascript">
      smoothScroll.init({
        speed: 500, // Integer. How fast to complete the scroll in milliseconds
        easing: 'easeInOutCubic', // Easing pattern to use
        offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
      });
    </script>
    <!-- <script src=" /js/scroll.min.js " charset="utf-8"></script> -->
  </body>

</html>
